<!doctype html>
<html class="no-js" lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>
    
    01 JavaScript Drum Kit 中文指南 - 十
    
  </title>
  <meta name="description" content="">
  <link href="atom.xml" rel="alternate" title="十" type="application/atom+xml">
  <link rel="stylesheet" href="asset/css/foundation.min.css" />
  <link rel="stylesheet" href="asset/css/docs.css" />
  <script src="asset/js/vendor/modernizr.js"></script>
  <script src="asset/js/vendor/jquery.js"></script>
  <script src="asset/highlightjs/highlight.pack.js"></script>
  <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script>
    hljs.initHighlightingOnLoad();
  </script>
</head>

<body class="antialiased hide-extras">
  <div class="marketing off-canvas-wrap" data-offcanvas>
    <div class="inner-wrap">
      <nav class="top-bar docs-bar hide-for-small" data-topbar>
        <div id="header">
          <h3><a href="index.html">十的对称 十的完美</a></h1>
        </div>
      </nav>
      <nav class="tab-bar show-for-small">
        <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
          <span> &nbsp;</span>
        </a>
        <div id="header">
          <h3><a href="index.html">十的对称 十的完美</a></h1>
        </div>
      </nav>
      <aside class="left-off-canvas-menu">
        <ul class="off-canvas-list">
          <li><a href="index.html">关于我</a></li>
          
          <li class="divider"></li>
          <li><label>JavaScript30</label></li>
          
          <li><a title="01 JavaScript Drum Kit" href="16089052254448.html">01 JavaScript Drum Kit</a></li>
          
          <li><a title="01 JavaScript Drum Kit 中文指南" href="16089048368062.html">01 JavaScript Drum Kit 中文指南</a></li>
          
          
          <li class="divider"></li>
          <li><label>杂念</label></li>
          
          <li><a title="努力了三个月的总结" href="16084764191221.html">努力了三个月的总结</a></li>
          
          
          <li class="divider"></li>
          <li><label>JavaScript</label></li>
          
          <li><a title="类型转换" href="16089553577924.html">类型转换</a></li>
          
          <li><a title="通过变量作用域深入了解undefined" href="16088182648987.html">通过变量作用域深入了解undefined</a></li>
          
          <li><a title="重新认识下熟悉的浏览器" href="16076922632055.html">重新认识下熟悉的浏览器</a></li>
          
          <li><a title="JavaScript类型转换" href="16087263047458.html">JavaScript类型转换</a></li>
          
          
          <li class="divider"></li>
          <li><label>重学前端--学习笔记</label></li>
          
          <li><a title="JavaScript全部的对象分类" href="16085442753431.html">JavaScript全部的对象分类</a></li>
          
          <li><a title="JavaScript的面向对象" href="16085441443213.html">JavaScript的面向对象</a></li>
          
          <li><a title="JavaScript中的类型" href="16083847578374.html">JavaScript中的类型</a></li>
          
          <li><a title="JavaScript原型和原型链" href="16080322533005.html">JavaScript原型和原型链</a></li>
          
          
          <li class="divider"></li>
          <li><label>Angular</label></li>
          
          <li><a title="angular mock的使用" href="16073237309370.html">angular mock的使用</a></li>
          
          
          <li class="divider"></li>
          <li><label>英语课</label></li>
          
          <li><a title="chapter 2 Dining" href="16089552578971.html">chapter 2 Dining</a></li>
          
          <li><a title="Chapter 1 Shopping" href="16089552264437.html">Chapter 1 Shopping</a></li>
          
          
        </ul>
      </aside>
      <a class="exit-off-canvas" href="#"></a>
      <section id="main-content" role="main" class="scroll-container">
        <div class="row">
          <div class="large-9 medium-9 columns">
  <div class="markdown-body">
  <div class="markdown-inside">
    <h1>01 JavaScript Drum Kit 中文指南</h1>
    <time class="article-date" datetime="2020-12-25T22:00:36+08:00">发布于2020/12/25</time>
    <blockquote>
<p>作者：©<a href="https://github.com/soyaine">未枝丫</a><br/><br/>
简介：<a href="https://javascript30.com">JavaScript30</a> 是 <a href="https://github.com/wesbos">Wes Bos</a> 推出的一个 30 天挑战。项目免费提供了 30 个视频教程、30 个挑战的起始文档和 30 个挑战解决方案源代码。目的是帮助人们用纯 JavaScript 来写东西，不借助框架和库，也不使用编译器和引用。现在你看到的是这系列指南的第 1 篇。完整指南在 <a href="https://github.com/soyaine/JavaScript30">GitHub</a>，喜欢请 Star 哦♪(<sup>∇<sup>*)</sup></sup></p>
</blockquote>

<h2 id="toc_0">实现效果</h2>

<p>模拟一个打鼓的页面。用户在键盘上按下 ASDFGHJKL 这几个键时，页面上与字母对应的按钮变大变亮，对应的鼓点声音响起来。</p>

<p><a href="http://soyaine.github.io/JavaScript30/01%20-%20JavaScript%20Drum%20Kit/index-SOYAINE.html">看在线效果</a></p>

<h2 id="toc_1">关键要点</h2>

<ol>
<li>键盘事件</li>
<li>播放声音</li>
<li>改变样式</li>
</ol>

<h2 id="toc_2">步骤分解</h2>

<ol>
<li><strong>添加键盘事件监听</strong>。在 window 上添加键盘 <code>keydown</code> 事件。</li>
<li><strong>对应事件处理程序。</strong>
<ol>
<li><strong>获取键码</strong></li>
<li><strong>用 <code>querySelector</code> 获取元素</strong></li>
<li><strong>获取 <code>data-key</code> 为对应键码的元素</strong></li>
<li><strong>处理元素</strong>。播放音频、添加样式。</li>
</ol></li>
<li><strong>为所有的 <code>div.key</code> 添加 <code>transitionened</code> 事件</strong>。
<ol>
<li><strong>获取所有样式为 <code>key</code> 的元素</strong></li>
<li><strong>为其添加事件监听</strong></li>
</ol></li>
<li><strong>去除样式的事件处理程序</strong></li>
</ol>

<h2 id="toc_3">基础语法</h2>

<h3 id="toc_4">一些 ES6 语法</h3>

<ol>
<li><p><code>const</code> ：声明一个只读的常量，标识符的值只能赋值一次。</p></li>
<li><p>`字符串 \({ 变量、属性名 } \`：模板字面量（Template literals）中用于表示模板字符串的标识。特点是字符串首尾用反引号（\`），内部的模板部分用 \){ } 括起来表示，具体请看<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/template_strings">MDN文档</a>。简单例子如下：</p>
<pre><code class="language-javascript">      var a = 1;
      var b = 2;<br/>
      //不用模板的写法<br/>
      console.log(&quot;三是&quot; + (a + b) + &quot;不是&quot; + (2 * a + b)); //&quot;三是3不是4&quot;<br/>
      //使用模板字符串的写法<br/>
      console.log(`三是${a + b}不是${2 * a + b}`); //&quot;三是3不是4&quot;
</code></pre></li>
</ol>

<h3 id="toc_5"><code>forEach</code> 与箭头函数</h3>

<p>使用 <code>document.querySelector</code> 获取一组符合 CSS 选择符的元素快照，类型为 NodeList（此对象是对于文档的实时运行的动态查询），对其进行遍历时可采用 <code>forEach</code> 方法。</p>

<pre><code class="language-javascript">// Code from http://es6-features.org/#StatementBodies

// ES6
nums.forEach(v =&gt; {
    if (v % 5 === 0)
        fives.push(v);
})

// ES5
nums.forEach(function (v) {
    if (v % 5 === 0)
        five.push(v);
})
</code></pre>

<h2 id="toc_6">解决难点</h2>

<h3 id="toc_7">如何将键盘按键与页面按钮对应起来？</h3>

<p>连接的帮手是 <code>keydown</code> 事件中的 <code>keyCode</code> 属性，<code>keyCode</code> 属性的值和 ASCII 编码值相同（对应小写字母）。在<a href="http://keycode.info/">这个网站</a>可以用按键盘来查看对应的键码。</p>

<p>我们能获取到的初始页面中，按钮 <code>div</code> 和音频 <code>audio</code> 标签中都添加了一个属性 <code>data-key</code> 用于存储对应的键码，这样做的目的是，添加键盘事件监听后，触发键盘事件时即可获取事件的 <code>keyCode</code> 属性值，以此为线索，操作对应的按钮及音频。</p>

<pre><code class="language-javascript">const audio = document.querySelector(`audio[data-key=&quot;${e.keyCode}&quot;]`);
const key = document.querySelector(`div[data-key=&quot;${e.keyCode}&quot;]`);
</code></pre>

<h3 id="toc_8">如何保证按键被按住不放时，可以马上响起连续鼓点声？</h3>

<p>每次播放音频之前，设置播放时间戳为 0：</p>

<pre><code class="language-javascript">var audio = document.getElementById(&quot;video&quot;); 
audio.currentTime = 0;
audio.play();
</code></pre>

<h3 id="toc_9">如何使页面按钮恢复原状？</h3>

<p>利用一个叫 <a href="https://developer.mozilla.org/zh-CN/docs/Web/Events/transitionend"><code>transitionend</code></a> 的事件，它在 CSS transition 结束后会被触发。我们就可以利用这个事件，在每次打鼓的效果（尺寸变大、颜色变化）完成之后，去除相应样式。</p>

<p>在这个页面中，发生 <code>transition</code> 的样式属性不止一个（<code>box-shadow</code>, <code>transform</code>, <code>border-color</code>），所以需要添加一个判断语句，使每发生一次按键事件时，只去除一次样式。</p>

<pre><code class="language-javascript">funciton remove(event) {
  if (event.propertyName !== &#39;border-left-color&#39;) return;
  this.classList.remove(&#39;playing&#39;);
  // event.target.classList.remove(&#39;playing&#39;);
}
</code></pre>

  </div>
</div>
<br /><br />
<hr />
<div class="row clearfix">
  <div class="large-6 columns">
    <div class="text-left" style="padding:15px 0px;">
      
      <a href="16089052254448.html" title="Previous Post: 01 JavaScript Drum Kit">&laquo;
        01 JavaScript Drum Kit</a>
      
    </div>
  </div>
  <div class="large-6 columns">
    <div class="text-right" style="padding:15px 0px;">
      
      <a href="16088182648987.html" title="Next Post: 通过变量作用域深入了解undefined">通过变量作用域深入了解undefined &raquo;</a>
      
    </div>
  </div>
</div>
<div class="row">
  <div style="padding:0px 0.93em;" class="share-comments">
    
  </div>
</div>
<script type="text/javascript">
  $(function () {
    var currentURL = '16089048368062.html';
    $('#side-nav a').each(function () {
      if ($(this).attr('href') == currentURL) {
        $(this).parent().addClass('active');
      }
    });
  });
</script>  
          </div>
          <div class="large-3 medium-3 columns">
            <div class="hide-for-small">
              <div class="sidebar">
                <nav>
                  <ul id="side-nav" class="side-nav">
                    
                    <li class="side-title"><span>JavaScript30</span></li>
                    
                    <li>
                      <a title="01 JavaScript Drum Kit" href="16089052254448.html">01 JavaScript Drum Kit</a>
                    </li>
                    
                    <li>
                      <a title="01 JavaScript Drum Kit 中文指南" href="16089048368062.html">01 JavaScript Drum Kit 中文指南</a>
                    </li>
                    
                    
                    <li class="side-title"><span>杂念</span></li>
                    
                    <li>
                      <a title="努力了三个月的总结" href="16084764191221.html">努力了三个月的总结</a>
                    </li>
                    
                    
                    <li class="side-title"><span>JavaScript</span></li>
                    
                    <li>
                      <a title="类型转换" href="16089553577924.html">类型转换</a>
                    </li>
                    
                    <li>
                      <a title="通过变量作用域深入了解undefined" href="16088182648987.html">通过变量作用域深入了解undefined</a>
                    </li>
                    
                    <li>
                      <a title="重新认识下熟悉的浏览器" href="16076922632055.html">重新认识下熟悉的浏览器</a>
                    </li>
                    
                    <li>
                      <a title="JavaScript类型转换" href="16087263047458.html">JavaScript类型转换</a>
                    </li>
                    
                    
                    <li class="side-title"><span>重学前端--学习笔记</span></li>
                    
                    <li>
                      <a title="JavaScript全部的对象分类" href="16085442753431.html">JavaScript全部的对象分类</a>
                    </li>
                    
                    <li>
                      <a title="JavaScript的面向对象" href="16085441443213.html">JavaScript的面向对象</a>
                    </li>
                    
                    <li>
                      <a title="JavaScript中的类型" href="16083847578374.html">JavaScript中的类型</a>
                    </li>
                    
                    <li>
                      <a title="JavaScript原型和原型链" href="16080322533005.html">JavaScript原型和原型链</a>
                    </li>
                    
                    
                    <li class="side-title"><span>Angular</span></li>
                    
                    <li>
                      <a title="angular mock的使用" href="16073237309370.html">angular mock的使用</a>
                    </li>
                    
                    
                    <li class="side-title"><span>英语课</span></li>
                    
                    <li>
                      <a title="chapter 2 Dining" href="16089552578971.html">chapter 2 Dining</a>
                    </li>
                    
                    <li>
                      <a title="Chapter 1 Shopping" href="16089552264437.html">Chapter 1 Shopping</a>
                    </li>
                    
                    
                  </ul>
                </nav>
              </div>
            </div>
          </div>
        </div>
        <div class="page-bottom">
          <div class="row">
            <hr />
            <div class="small-9 columns">
              <p class="copyright">Contact Me&nbsp;
                Tel: +86 18641188786,&nbsp;
                mail: 416376663@qq.com</p>
            </div>
            <div class="small-3 columns">
              <p class="copyright text-right"><a href="#top">TOP</a></p>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>
  <script src="asset/js/foundation.min.js"></script>
  <script src="asset/js/foundation/foundation.offcanvas.js"></script>
  <script>
    $(document).foundation();
  </script>
  
  
  
</body>

</html>